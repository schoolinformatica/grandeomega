@using System.Linq;
@using System.Net.Http.Headers
@using Clustering
@using Data
@using Highcharts

@{
    ViewData["Title"] = "Home Page";
}

@{
    var gradedStudents = Students.students.Where(x => x.Grade > 0);

    foreach (var student in gradedStudents)
    {
        student.Filter();
    }

    var data = new DataSet(gradedStudents.Select(x => x.ToGenericVector()).ToList());

    var d = new Dbscan(50, 3, data);
    var k = new Kmeans(4, 100, data);
    d.Run();
    k.Run();
}

<div class="row">
    <h1>Statistics</h1>
    <div id="plotdbscan" style="min-width: 310px; height: 400px; max-width: 800px; margin: 0 auto"></div>
    <div id="plotkmeans" style="min-width: 310px; height: 400px; max-width: 800px; margin: 0 auto"></div>

    <script src="~/lib/highcharts/highcharts.js"></script>
</div>


@{
    var dataKmeans = new List<DataSet>();
    var plotDbscan = new Chart("plotdbscan");
    var plotKmeans = new Chart("plotkmeans");

    foreach (var cluster in d.DataClusters)
    {
        plotDbscan.AddDataSeries(new DataSeries("scatter", new DataSet(cluster.Select(x => x as GenericVector).ToList()), "Cluster " + cluster.Key));
    }

    foreach (var cluster in k.DataClusters)
    {
        plotKmeans.AddDataSeries(new DataSeries("scatter", new DataSet(cluster.Select(x => x as GenericVector).ToList()), "Cluster " + cluster.Key));
    }

    plotDbscan.Set("chart", "scatter");
    plotDbscan.Set("title", "Cluster Dbscan");
    plotKmeans.Set("chart", "scatter");
    plotKmeans.Set("title", "Cluster Kmeans");
}

@Html.Raw(plotDbscan.CreateTemplate())
@Html.Raw(plotKmeans.CreateTemplate())